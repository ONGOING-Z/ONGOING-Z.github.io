<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Debug 的经验 | ongoing's blog</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css></head><body><nav><ul class=menu><li><a href=/>首页</a></li><li><a href=/categories/>分类</a></li><li><a href=/about/>关于</a></li></ul><hr></nav><div class=article-meta><h1><span class=title>Debug 的经验</span></h1><h2 class=date>2025/04/05</h2></div><main><h3 id=一背景>一、背景</h3><p>这里存放一些优化调试行为的点。</p><h3 id=二场景>二、场景</h3><h4 id=一>（一）</h4><p>单元方法测试为了验证某个 assertNull(a), 可以在执行中直接 F2 修改原变量为 null，验证是否跑到。如果是整个服务范围的测试，建议从业务逻辑上考虑造出这样的数据。</p><h4 id=二条件断点语句>（二）条件断点语句</h4><p>IDEA debug 查看当前 BeanPostProcessor 类型的变量 pp 是否为 InfrastructureAdvisorAutoProxyCreator，断点语句应该怎么写？</p><img src=problem.png alt><p>条件断点表达式这样写：</p><p><code>pp.getClass() == org.springframework.aop.framework.autoproxy.InfrastructureAdvisorAutoProxyCreator.class</code></p><h4 id=三给每个测试方法都起自定义名称>（三）给每个测试方法都起自定义名称</h4><p>核心价值在于让测试报告自解释，使团队能快速理解测试目的，尤其在复杂业务场景中大幅提升维护效率。推荐为所有测试方法添加此注解以提升代码可读性。</p><img src=debug_test_display_name.png alt><h4 id=四强制跳过所有断点>（四）强制跳过所有断点</h4><img src=force_run_to_cursor.png alt><h4 id=五异步调试>（五）异步调试</h4><p>尽量延长 main 线程的时长，在 main 方法体最后写上一句 sleep 语句，因为在测试时如果 main 线程 (非守护线程) 退出了，jvm 也会退出，这样的话就可能观察不到异步线程里的行为了。</p></main><script>document.addEventListener("DOMContentLoaded",function(){const e=new PhotoSwipeLightbox({gallery:".pswp-gallery",children:"a",pswpModule:PhotoSwipe});e.init()})</script>