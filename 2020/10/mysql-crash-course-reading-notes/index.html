<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>MySQL crash course reading notes | ongoing's blog</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css></head><body><nav><ul class=menu><li><a href=/>首页</a></li><li><a href=/categories/>分类</a></li><li><a href=/about/>关于</a></li></ul><hr></nav><div class=article-meta><h1><span class=title>MySQL crash course reading notes</span></h1><h2 class=date>2020/10/02</h2></div><main><p>记录一些在读这本书<a href=https://book.douban.com/subject/3354490/ target=_blank rel="noopener noreferrer">《mysql必知必会》</a>时一些重要的概念。</p><hr><h3 id=一了解数据库>一、了解数据库</h3><ul><li>database</li><li>table(column, datatype, row)</li><li>row == record</li><li>schema(模式): 关于数据库和表的布局及特性的信息</li><li>primary key</li><li>表中任何列都可以作为主键<ul><li>任意两行都不具有相同的主键值</li><li>每个行都必须具有一个主键值(主键列不允许NULL值)</li></ul></li><li>sql(structured query language): 结构化查询语言</li></ul><h3 id=二mysql简介>二、mysql简介</h3><p>MySQL命令行登录</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql -u root -p
</span></span></code></pre></div><h3 id=三使用mysql>三、使用mysql</h3><ul><li>使用数据库 = use database_name;</li><li>显示数据库 = show databases;</li><li>获得数据库内表的列表 = show tables;</li><li>显示表列 = show columns from table_name;</li><li>自增量 = auto_increment</li></ul><h3 id=4th-检索数据>4th 检索数据</h3><p>mysql命令行<strong>必须加上分号</strong>来结束sql语句。
sql语句不区分大小写，但是对关键字进行大写更易于阅读。</p><ul><li><p>检索单个列</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> prod_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> <span style=color:#66d9ef>table_name</span>;
</span></span></code></pre></div></li><li><p>检索多个列 = 在select后给出多个列名，列名间有逗号。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> col1, col2, col3
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> <span style=color:#66d9ef>table_name</span>;
</span></span></code></pre></div></li><li><p>检索所有列(最后不要随便使用<code>*</code>)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> <span style=color:#66d9ef>table_name</span>;
</span></span></code></pre></div></li><li><p>distinct关键字</p></li><li><p>limit 关键字(第一条记录号为0)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> col_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>limit</span> <span style=color:#ae81ff>5</span>; <span style=color:#f92672>//</span> <span style=color:#960050;background-color:#1e0010>指示</span>mysql返回不多于5行
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> col_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>limit</span> <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>; <span style=color:#f92672>//</span> <span style=color:#960050;background-color:#1e0010>从第</span><span style=color:#ae81ff>5</span><span style=color:#960050;background-color:#1e0010>行开始检索</span><span style=color:#ae81ff>5</span><span style=color:#960050;background-color:#1e0010>行</span>(<span style=color:#960050;background-color:#1e0010>不包括开始行</span>)
</span></span></code></pre></div></li><li><p>完全限定表名引用列</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#66d9ef>table_name</span>.col_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> <span style=color:#66d9ef>table_name</span>;
</span></span></code></pre></div></li></ul><h3 id=5th-排序检索order-by>5th 排序检索(order by)</h3><p>order by子句位于from子句之后。</p><ul><li><p>clause(子句)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> col_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> col_name, col_name2;
</span></span></code></pre></div></li><li><p>order by排序方向(desc, asc)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> col_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> col_name <span style=color:#66d9ef>asc</span><span style=color:#f92672>/</span><span style=color:#66d9ef>desc</span>;
</span></span></code></pre></div><p>// 实际上asc没什么用，默认是升序的。</p></li><li><p>使用<code>order by</code>和<code>limit</code>的组合，得到一个列中最高或最低的值</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> col_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> col_name <span style=color:#66d9ef>desc</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>limit</span> <span style=color:#ae81ff>1</span>;
</span></span></code></pre></div></li></ul><h3 id=6th-过滤数据where>6th 过滤数据(where)</h3><ul><li>where clause 在 from clause之后</li><li>同时使用<code>where</code>和<code>order by</code>时，order by应该在where之后</li><li>where 子句操作符<ul><li><code>=</code></li><li><code>&lt;></code> / <code>!=</code></li><li><code>&lt;</code></li><li><code>&lt;=</code></li><li><code>></code></li><li><code>>=</code></li><li><code>between</code> = 在两个值之间, 这两个值使用<code>AND</code>分隔</li></ul></li><li><code>is null</code> = 检测空值</li></ul><h3 id=10th-计算字段>10th 计算字段</h3><ul><li><p>as = 使用别名</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span> col_name <span style=color:#66d9ef>as</span> another_name
</span></span></code></pre></div></li></ul><h3 id=11th-数据处理函数>11th 数据处理函数</h3><ul><li>upper(col_name) = 将文本转换为大写</li><li>很多日期处理函数</li><li>abs()</li><li>mod()</li><li>rand()</li><li>sqrt()</li><li>round(col_name, a) = a是小数点位数</li></ul><h3 id=12th-汇总数据>12th 汇总数据</h3><ul><li>aggregate function<ul><li>avg() = 返回某列平均值</li><li>count() = 返回某列行数</li><li>max() = 返回某列最大值</li><li>min() = 返回某列最小值</li><li>sum() = 返回某列值之和</li></ul></li></ul><h3 id=13th-分组数据group-by--having>13th 分组数据(group by / having)</h3><ul><li>group by = 在 where后，order by之前</li></ul><h3 id=14th-subquery>14th subquery</h3><ul><li>在select语句中，子查询总是从内向外处理</li></ul><h3 id=15th-联结表join>15th 联结表(join)</h3><ul><li>外键(foreigh key) = 为某个表的一列，它包含另一个表的主键值，定义了两个表的关系。<ul><li>好处1 = 减少信息的重复</li></ul></li><li>在引用的列可能出现二义性时，必须使用完全限定列名(table_name.col_name)</li></ul><h3 id=16th-创建高级联结>16th 创建高级联结</h3><ol><li>使用表别名(<code>AS</code>)</li></ol><ul><li>缩短sql语句</li></ul><h3 id=updatetand-delete08--00>updateTand delete+08 = &lsquo;00&rsquo;</h3><ul><li><p>don&rsquo;t ignore where clause
-updateTtable_name set xxx=&lsquo;xxx where xxx+08 = 00&rsquo;</p></li><li><p>delete a row</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>delete</span> <span style=color:#66d9ef>from</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span> col_name <span style=color:#f92672>=</span> xxx;
</span></span></code></pre></div></li></ul><h3 id=alter-table>alter table</h3><ul><li><p>add a column</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> vendors
</span></span><span style=display:flex><span><span style=color:#66d9ef>add</span> vend_phone char(<span style=color:#ae81ff>20</span>);
</span></span></code></pre></div></li><li><p>delete table = <code>drop table table_name;</code></p></li></ul><h3 id=view>view</h3><ul><li>create view = <code>create view view_name</code></li><li>drop view = <code>drop view view_name;</code></li></ul><h3 id=其他>其他</h3><ol><li><p>mysql注释</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f92672>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>/* */</span>
</span></span></code></pre></div></li><li><p>在一行代码中插入多条数据</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> <span style=color:#66d9ef>table_name</span> <span style=color:#66d9ef>values</span> (), (), ...
</span></span></code></pre></div></li><li><p>mysql修改表名(两种方法)</p><ul><li><code>rename</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>RENAME</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span> <span style=color:#66d9ef>TO</span> another_table_name;
</span></span></code></pre></div><ul><li>ALTER TABLE table_name RENAME TO another_name</li></ul></li><li><p>replace更改数据</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>UPDATE</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SET</span> field_name <span style=color:#f92672>=</span> <span style=color:#66d9ef>REPLACE</span>(field_name, from_data, to_data)
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span> xxx;
</span></span></code></pre></div></li><li><p>set关键字更新列(用逗号连接多个)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>set</span> col_name<span style=color:#f92672>=</span>new_data, col_name2<span style=color:#f92672>=</span>new_data2...
</span></span></code></pre></div></li><li><p>创建表</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>IF</span> <span style=color:#66d9ef>EXISTS</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span>(xxx,
</span></span><span style=display:flex><span>xxx,
</span></span><span style=display:flex><span>xxx,
</span></span><span style=display:flex><span><span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>(pid));
</span></span></code></pre></div></li><li><p>substr()</p><p>substr(字符串，起始位置，长度）
起始位置 =截取的子串的起始位置（注意:字符串的第一个字符的索引是1）。值为正时从字符串开始位置 开始计数，值为负时从字符串结尾位置开始计数。
长度 =截取子串的长度</p></li><li><p>add column in table</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>ADD</span> <span style=color:#66d9ef>column_name</span> datatype
</span></span></code></pre></div></li><li><p>primary key and unique index</p></li></ol><p>主键约束比唯一索引约束严格，当没有设定主键时，非空唯一索引自动称为主键。对于主键和唯一索引的一些区别主要如下：</p><ul><li>主键不允许空值，唯一索引允许空值</li><li>主键只允许一个，唯一索引允许多个</li></ul><hr><p>MySQL必备神器&ndash;mycli(补全)</p><ul><li>Install(ubuntu): <code>sudo apt-get install mycli</code></li><li>Login(cli): <code>mycli -u name -p passward</code></li></ul></main><script>document.addEventListener("DOMContentLoaded",function(){const e=new PhotoSwipeLightbox({gallery:".pswp-gallery",children:"a",pswpModule:PhotoSwipe});e.init()})</script>